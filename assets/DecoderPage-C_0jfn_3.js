import{Q as M}from"./QPage-CFwF4HDn.js";import{a as o,u as a}from"./cpu-B04Mnmr_.js";import{d as x,c as I,Q as v,R as b,a1 as p,V as t,Y as l,$ as c,F as i,U as r,a0 as w,X as S}from"./index-CfVvsZp1.js";import"./render-B8yKuth0.js";const W=new Set(["JN","JZ","JO","RR","RW","AR","AW","BR","BW","ALU1","ALU2"]),_=["value","onInput"],B=["checked","onInput"],F=["checked","onInput"],L=x({__name:"DecoderPage",setup(A){const m=I(()=>a().cpu.decoderState),k=W,g={Fetch:o.Fetch,Decode:o.Decode,Read:o.Read,Execute:o.Execute,Write:o.Write};function D(u,n){const e=h();e.instructions[u].name=n,a().cpu=S(a().cpu.withNewDecoder(e))}function f(u,n,e){const s=h();e?s.instructions[u].gates.add(n):s.instructions[u].gates.delete(n),a().cpu=S(a().cpu.withNewDecoder(s))}function y(u,n,e){const s=h();e?s.timingMasks[u].add(n):s.timingMasks[u].delete(n),a().cpu=S(a().cpu.withNewDecoder(s))}function h(){const u=m.value;return{timingMasks:{[o.Fetch]:new Set(u.timingMasks[o.Fetch]),[o.Decode]:new Set(u.timingMasks[o.Decode]),[o.Read]:new Set(u.timingMasks[o.Read]),[o.Execute]:new Set(u.timingMasks[o.Execute]),[o.Write]:new Set(u.timingMasks[o.Write])},instructions:u.instructions.map(n=>({name:n.name,gates:new Set(n.gates)}))}}return(u,n)=>(r(),v(p(M),{padding:""},{default:b(()=>[t("div",null,[n[2]||(n[2]=t("h2",null,"Decoder",-1)),t("table",null,[t("thead",null,[t("tr",null,[n[0]||(n[0]=t("th",null,"Instruction",-1)),(r(!0),l(i,null,c(p(k),e=>(r(),l("th",{key:e},w(e),1))),128))])]),t("tbody",null,[(r(),l(i,null,c(16,e=>t("tr",{key:e},[t("td",null,[t("input",{type:"text",value:m.value.instructions[e-1].name,onInput:s=>D(e-1,s.target.value)},null,40,_)]),(r(!0),l(i,null,c(p(k),s=>(r(),l("td",{key:s},[t("input",{type:"checkbox",checked:m.value.instructions[e-1].gates.has(s),onInput:d=>f(e-1,s,d.target.checked)},null,40,B)]))),128))])),64))])]),n[3]||(n[3]=t("br",null,null,-1)),t("table",null,[t("thead",null,[t("tr",null,[n[1]||(n[1]=t("th",null,"Timing mask",-1)),(r(!0),l(i,null,c(p(k),e=>(r(),l("th",{key:e},w(e),1))),128))])]),t("tbody",null,[(r(),l(i,null,c(g,(e,s)=>t("tr",{key:s},[t("td",null,w(s),1),(r(!0),l(i,null,c(p(k),d=>(r(),l("td",{key:d},[t("input",{type:"checkbox",checked:m.value.timingMasks[e].has(d),onInput:R=>y(e,d,R.target.checked)},null,40,F)]))),128))])),64))])])])]),_:1}))}});export{L as default};
