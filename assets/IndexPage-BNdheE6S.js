var le=Object.defineProperty;var ae=(e,t,l)=>t in e?le(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l;var T=(e,t,l)=>ae(e,typeof t!="symbol"?t+"":t,l);import{k as ne,g as re,t as N,c as $,h as ue,a as Q,u as se,M as oe,w as ie,r as c,N as z,d as R,X as x,S as h,U as i,Y as _,Z as O,F,_ as D,f as r,W as C,$ as a,a0 as A,a1 as B,i as I,O as X,K as de,a2 as ve,a3 as ce,Q as me}from"./index-CmDH_T3n.js";import{h as pe}from"./render-DFgQjt0_.js";const ge=ne({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(e,{slots:t}){const{proxy:{$q:l}}=re(),u=Q(se,N);if(u===N)return console.error("QPage needs to be a deep child of QLayout"),N;if(Q(oe,N)===N)return console.error("QPage needs to be child of QPageContainer"),N;const p=$(()=>{const v=(u.header.space===!0?u.header.size:0)+(u.footer.space===!0?u.footer.size:0);if(typeof e.styleFn=="function"){const g=u.isContainer.value===!0?u.containerHeight.value:l.screen.height;return e.styleFn(v,g)}return{minHeight:u.isContainer.value===!0?u.containerHeight.value-v+"px":l.screen.height===0?v!==0?`calc(100vh - ${v}px)`:"100vh":l.screen.height-v+"px"}}),d=$(()=>`q-page${e.padding===!0?" q-layout-padding":""}`);return()=>ue("main",{class:d.value,style:p.value},pe(t.default))}});var U=(e=>(e[e.Fetch=0]="Fetch",e[e.Decode=1]="Decode",e[e.Read=2]="Read",e[e.Execute=3]="Execute",e[e.Write=4]="Write",e))(U||{});const P=class P{constructor(t){this.decoderState=t,globalThis.cpu=this,ie(()=>this.instructionsOp[this.pc.value],()=>{this.stage===1&&(this.decodedStages=this.decodeStages(this.pc.value))}),this.decodedStages=this.decodeStages(this.pc.value)}_stage=c(0);pc=c(0);address=$(()=>this.instructionsAddr[this.pc.value]);regA=c(0);regB=c(0);flagZ=c(!1);flagO=c(!1);_pcJump=$(()=>{const t=this._jmpNot.value,l=this._jmpOverflow.value,u=this._jmpZero.value;if(!l&&!u)return t;const m=(u?this.flagZ.value:!0)&&(l?this.flagO.value:!0);return t?!m:m});_jmpNot=c(!1);_jmpZero=c(!1);_jmpOverflow=c(!1);_regAWrite=c(!1);_regARead=c(!1);_regBWrite=c(!1);_regBRead=c(!1);_ramWrite=c(!1);_ramRead=c(!1);_aluOp1=c(!1);_aluOp2=c(!1);_aluOp=$(()=>(this._aluOp1.value?1:0)+(this._aluOp2.value?2:0));_aluInA=c(0);_aluInB=c(0);_regAOut=c(0);_regBOut=c(0);_aluOut=c(0);_ramOut=c(0);data=$(()=>(this._regARead.value?this._regAOut.value:0)|(this._regBRead.value?this._regBOut.value:0)|(this._aluOp.value?this._aluOut.value:0)|(this._ramRead.value?this._ramOut.value:0)|this.instructionsData[this.pc.value]);aluInA=$(()=>this._aluOp.value===0?this.regA.value:this._aluInA.value);aluInB=$(()=>this._aluOp.value===0?this.regB.value:this._aluInB.value);get pcJump(){return this._pcJump.value}get stage(){return this._stage.value}set stage(t){if(t!==this._stage.value){switch(t){case 0:{const l=this.pcJump?this.address.value:this.pc.value+1&15;this.pc.value=l;break}case 1:this.decodedStages=this.decodeStages(this.pc.value);break}this._stage.value=t}}get jmpNot(){return this._jmpNot.value}get jmpZero(){return this._jmpZero.value}get jmpOverflow(){return this._jmpOverflow.value}get regAWrite(){return this._regAWrite.value}get regARead(){return this._regARead.value}get regBWrite(){return this._regBWrite.value}get regBRead(){return this._regBRead.value}get ramWrite(){return this._ramWrite.value}get ramRead(){return this._ramRead.value}get aluOp(){return this._aluOp.value}ram=z(Array(16).fill(0));instructionsOp=z(Array(16).fill(0));instructionsAddr=z(Array(16).fill(0));instructionsData=z(Array(16).fill(0));execAluOp(){const t=this.aluOp,l=this.regA.value,u=this.regB.value;switch(t){case 1:return l&u;case 2:return l+u;case 3:return l-u}return 0}nextStage(){const t=this.stage,l=P.NextStage[t],u=this.decodedStages[t],m=this.decodedStages[l];for(const d of Object.keys(this.gateMap)){const v=this.gateMap[d];v.value=m.has(d)}const p=m.difference(u);this.processGateActivations(p),this.stage=l}processGateActivations(t){if(t.has("AR")&&(this._regAOut.value=this.regA.value),t.has("BR")&&(this._regBOut.value=this.regB.value),t.has("RR")&&(this._ramOut.value=this.ram[this.address.value]),t.has("AW")&&(this.regA.value=this.data.value),t.has("BW")&&(this.regB.value=this.data.value),t.has("RW")&&(this.ram[this.address.value]=this.data.value),t.has("ALU1")||t.has("ALU2")){const l=this.execAluOp();this._aluInA.value=this.regA.value,this._aluInB.value=this.regB.value,this._aluOut.value=l&15,this.flagZ.value=this._aluOut.value===0,this.flagO.value=l>15||l<0}}step(){do this.nextStage();while(this.stage!==0)}decodedStages;decodeStage(t,l){const u=this.decoderState.instructions[t].gates,m=this.decoderState.timingMasks[l];return u.intersection(m)}decodeStages(t){const l=this.decoderState.instructions[this.instructionsOp[t]].gates,u=this.decoderState.timingMasks;return{0:l.intersection(u[0]),1:l.intersection(u[1]),2:l.intersection(u[2]),3:l.intersection(u[3]),4:l.intersection(u[4])}}gateMap={JN:this._jmpNot,JZ:this._jmpZero,JO:this._jmpOverflow,RR:this._ramRead,RW:this._ramWrite,AR:this._regARead,AW:this._regAWrite,BR:this._regBRead,BW:this._regBWrite,ALU1:this._aluOp1,ALU2:this._aluOp2}};T(P,"NextStage",{0:1,1:2,2:3,3:4,4:0});let q=P;const fe={id:"alu",style:{transform:"translate(984px, 400px)"}},ye=1,he=2,xe=3,be=R({__name:"ALU",props:{select:{type:Number,required:!0},flagZ:{type:Boolean,required:!0},flagO:{type:Boolean,required:!0}},emits:["update:flagZ","update:flagO"],setup(e,{emit:t}){const l=e,u=t,m=$(()=>l.select===ye),p=$(()=>l.select===he),d=$(()=>l.select===xe);return(v,g)=>(h(),x("g",fe,[g[7]||(g[7]=i("path",{class:"component-bg",d:"m 0,0 h 376 v 104 l -88,88 h -200 l -88,-88 z"},null,-1)),i("g",{class:_({"alu-btn":!0,active:e.flagZ}),onClick:g[0]||(g[0]=S=>u("update:flagZ",!e.flagZ))},g[2]||(g[2]=[i("rect",{width:"32",height:"32",x:"8",y:"24",fill:"#000"},null,-1),i("text",{x:"24",y:"40"}," Z ",-1)]),2),i("g",{class:_({"alu-btn":!0,active:e.flagO}),onClick:g[1]||(g[1]=S=>u("update:flagO",!e.flagO))},g[3]||(g[3]=[i("rect",{width:"32",height:"32",x:"8",y:"64"},null,-1),i("text",{x:"24",y:"80"}," O ",-1)]),2),g[8]||(g[8]=i("text",{class:"component-label",x:"151",y:"41"}," ALU ",-1)),i("g",{class:_({"alu-btn":!0,active:m.value})},g[4]||(g[4]=[i("rect",{width:"64",height:"32",x:"88",y:"64"},null,-1),i("text",{x:"120",y:"80"}," AND ",-1)]),2),i("g",{class:_({"alu-btn":!0,active:p.value})},g[5]||(g[5]=[i("rect",{width:"64",height:"32",x:"160",y:"64"},null,-1),i("text",{x:"192",y:"80"}," ADD ",-1)]),2),i("g",{class:_({"alu-btn":!0,active:d.value})},g[6]||(g[6]=[i("rect",{width:"64",height:"32",x:"232",y:"64"},null,-1),i("text",{x:"264",y:"80"}," SUB ",-1)]),2)]))}}),M=(e,t)=>{const l=e.__vccOpts||e;for(const[u,m]of t)l[u]=m;return l},ke=M(be,[["__scopeId","data-v-573cae54"]]),we=["width","height","x","y"],Ae=R({__name:"BusLane",props:{x:Number,y:Number,dir:{required:!0,type:String},length:{required:!0,type:Number},value:Boolean},setup(e){const t=e,l=$(()=>t.dir==="vertical");return(u,m)=>(h(),x("rect",{class:_({active:e.value}),width:l.value?8:e.length,height:l.value?e.length:8,x:e.x??0,y:e.y??0},null,10,we))}}),b=M(Ae,[["__scopeId","data-v-68762ac2"]]),w=R({__name:"BusLanes",props:{x:Number,y:Number,dir:{required:!0,type:String},length:{required:!0,type:Number},taperedStart:{type:Boolean},taperedEnd:{type:Boolean},value:{required:!0,type:Number}},setup(e){const t=e,l=$(()=>t.dir==="vertical");function u(p){const d=1<<p;return{key:`lane_${p}`,get x(){if(l.value)return 16*(3-p);{let v=0;return t.taperedStart&&(v+=16*(3-p)),v}},get y(){if(l.value){let v=0;return t.taperedStart&&(v+=16*(3-p)),v}else return 16*(3-p)},get length(){const v=t.length;if(!t.taperedStart&&!t.taperedEnd)return v;if(t.taperedStart&&t.taperedEnd)return v-48;if(t.taperedStart&&!t.taperedEnd)return v-16*(3-p);if(!t.taperedStart&&t.taperedEnd)return v-48+16*(3-p)},get value(){return!!(t.value&d)},get dir(){return l.value?"vertical":"horizontal"}}}const m=[u(3),u(2),u(1),u(0)];return(p,d)=>(h(),x("g",{style:O({transform:"translate("+e.x+"px, "+e.y+"px)"})},[(h(),x(F,null,D(m,v=>r(b,{key:v.key,value:v.value,dir:e.dir,length:v.length,x:v.x,y:v.y},null,8,["value","dir","length","x","y"])),64))],4))}}),Be=R({__name:"StepIndicator",props:{x:{type:Number,required:!0},y:{type:Number,required:!0},label:{type:String,required:!0},active:{type:Boolean,required:!0}},setup(e){return(t,l)=>(h(),x("g",{style:O(`transform: translate(${e.x}px, ${e.y}px)`)},[l[0]||(l[0]=i("path",{style:{fill:"#e6e6e6"},d:"m 0,0 36,36 -36,36 h 192 l 36,-36 -36,-36 z"},null,-1)),i("text",{class:_(["component-label",{active:e.active}]),x:"116",y:"36"},C(e.label),3)],4))}}),Z=M(Be,[["__scopeId","data-v-35cab3fc"]]),Ve={id:"decoder_timer"},$e=R({__name:"ControlUnit",props:{cpu:{type:q,required:!0}},setup(e,{expose:t}){const l=e;function u(){l.cpu.nextStage()}function m(){l.cpu.step()}return t({doFocus(){}}),(p,d)=>(h(),x("g",Ve,[d[4]||(d[4]=i("rect",{class:"component-bg",width:"1888",height:"72",x:"16",y:"32"},null,-1)),d[5]||(d[5]=i("text",{class:"component-label",x:"45",y:"80"}," Decoder & Timer ",-1)),r(Z,{x:336,y:32,label:"Fetch",active:e.cpu.stage===a(U).Fetch},null,8,["active"]),r(Z,{x:544,y:32,label:"Decode",active:e.cpu.stage===a(U).Decode},null,8,["active"]),r(Z,{x:752,y:32,label:"Read",active:e.cpu.stage===a(U).Read},null,8,["active"]),r(Z,{x:960,y:32,label:"Execute",active:e.cpu.stage===a(U).Execute},null,8,["active"]),r(Z,{x:1168,y:32,label:"Write",active:e.cpu.stage===a(U).Write},null,8,["active"]),i("g",{class:"btn",onClick:d[0]||(d[0]=v=>u()),style:{transform:"translate(1400px, 40px)"},tabindex:"0"},d[2]||(d[2]=[i("rect",{width:"56",height:"56",x:"0",y:"0"},null,-1),i("path",{d:"m 15,13 v 5 l 17,10 -17,10 v 5 l 27,-15 z"},null,-1)])),i("g",{class:"btn",onClick:d[1]||(d[1]=v=>m()),style:{transform:"translate(1464px, 40px)"},tabindex:"0"},d[3]||(d[3]=[i("rect",{width:"56",height:"56",x:"0",y:"0"},null,-1),i("path",{d:"m 16,43 0,-31 L 43,28 Z"},null,-1)])),d[6]||(d[6]=i("g",{class:"btn",style:{transform:"translate(1528px, 40px)"},tabindex:"0"},[i("rect",{width:"56",height:"56",x:"0",y:"0"}),i("path",{d:"M 6,13 V 43 L 24,33 V 43 L 50,28 23,13 V 23 Z"})],-1))]))}}),Re=M($e,[["__scopeId","data-v-0b6997c5"]]),Oe={x:"16",y:"16",height:"32",width:"32"},Se=R({__name:"BitBtn",props:{x:Number,y:Number,modelValue:Boolean},emits:["update:modelValue"],setup(e,{expose:t,emit:l}){const u=c(null);t({doFocus(){const p=u.value;p&&p.focus()}});const m=l;return(p,d)=>(h(),x("g",{class:_({active:e.modelValue}),style:O({transform:"translate("+e.x+"px, "+e.y+"px)"}),onClick:d[0]||(d[0]=v=>m("update:modelValue",!e.modelValue)),onKeypress:d[1]||(d[1]=v=>m("update:modelValue",!e.modelValue)),tabindex:"0",ref_key:"focusTarget",ref:u},[d[2]||(d[2]=i("rect",{width:"32",height:"32"},null,-1)),i("text",Oe,C(e.modelValue?"1":"0"),1)],38))}}),E=M(Se,[["__scopeId","data-v-bb6dead5"]]),j=R({__name:"WordBits",props:{x:Number,y:Number,modelValue:{type:Number,required:!0},blocked:{type:Boolean,default:!1}},emits:["update:modelValue","up","down"],setup(e,{expose:t,emit:l}){const u=e,m=l;function p(V){return $({get(){return!!(u.modelValue&V)},set(){u.blocked||m("update:modelValue",u.modelValue^V)}})}t({doFocus(V=0){o[V]?.value?.doFocus()}});const d=p(1),v=p(2),g=p(4),S=p(8),W=c(null),n=c(null),y=c(null),s=c(null),o=[s,y,n,W];return(V,f)=>(h(),x("g",{style:O({transform:"translate("+e.x+"px, "+e.y+"px)",opacity:e.blocked?.5:1})},[r(E,{modelValue:a(S),"onUpdate:modelValue":f[0]||(f[0]=k=>I(S)?S.value=k:null),x:0,y:0,style:O(e.blocked?"cursor: not-allowed":""),ref_key:"comp_bit3",ref:W,onKeydown:[f[1]||(f[1]=A(B(k=>n.value?.doFocus(),["stop"]),["right"])),f[2]||(f[2]=A(B(k=>V.$emit("down",3),["stop"]),["down"])),f[3]||(f[3]=A(B(k=>V.$emit("up",3),["stop"]),["up"]))]},null,8,["modelValue","style"]),r(E,{modelValue:a(g),"onUpdate:modelValue":f[4]||(f[4]=k=>I(g)?g.value=k:null),x:40,y:0,ref_key:"comp_bit2",ref:n,style:O(e.blocked?"cursor: not-allowed":""),onKeydown:[f[5]||(f[5]=A(B(k=>y.value?.doFocus(),["stop"]),["right"])),f[6]||(f[6]=A(B(k=>W.value?.doFocus(),["stop"]),["left"])),f[7]||(f[7]=A(B(k=>V.$emit("up",2),["stop"]),["up"])),f[8]||(f[8]=A(B(k=>V.$emit("down",2),["stop"]),["down"]))]},null,8,["modelValue","style"]),r(E,{modelValue:a(v),"onUpdate:modelValue":f[9]||(f[9]=k=>I(v)?v.value=k:null),x:80,y:0,ref_key:"comp_bit1",ref:y,style:O(e.blocked?"cursor: not-allowed":""),onKeydown:[f[10]||(f[10]=A(B(k=>s.value?.doFocus(),["stop"]),["right"])),f[11]||(f[11]=A(B(k=>n.value?.doFocus(),["stop"]),["left"])),f[12]||(f[12]=A(B(k=>V.$emit("up",1),["stop"]),["up"])),f[13]||(f[13]=A(B(k=>V.$emit("down",1),["stop"]),["down"]))]},null,8,["modelValue","style"]),r(E,{modelValue:a(d),"onUpdate:modelValue":f[14]||(f[14]=k=>I(d)?d.value=k:null),x:120,y:0,ref_key:"comp_bit0",ref:s,style:O(e.blocked?"cursor: not-allowed":""),onKeydown:[f[15]||(f[15]=A(B(k=>y.value?.doFocus(),["stop"]),["left"])),f[16]||(f[16]=A(B(k=>V.$emit("up",0),["stop"]),["up"])),f[17]||(f[17]=A(B(k=>V.$emit("down",0),["stop"]),["down"]))]},null,8,["modelValue","style"])],4))}}),_e=R({__name:"CounterArrow",props:{x:{required:!0,type:Number},y:{required:!0,type:Number}},setup(e){return(t,l)=>(h(),x("path",{d:"M 0 0 V 16 L 14 8 Z",style:O(`transform: translate(${e.x}px, ${e.y}px)`)},null,4))}}),Y=M(_e,[["__scopeId","data-v-326f9dde"]]),We=R({__name:"DirectionArrow",props:{x:{required:!0,type:Number},y:{required:!0,type:Number},dir:{required:!0,type:String},value:{required:!0,type:Boolean}},setup(e){const t=e,l=$(()=>t.dir==="up"),u=$(()=>`transform: translate(${t.x}px,${t.y}px)`);return(m,p)=>l.value?(h(),x("path",{key:0,class:_({active:e.value}),style:O(u.value),d:"m 12,0 -12,14 h 8 v 16 h 8 v -16 h 8 z"},null,6)):(h(),x("path",{key:1,class:_({active:e.value}),style:O(u.value),d:"m 8,0 v 16 h -8 l 12,14 12,-14 h -8 v -16 z"},null,6))}}),K=M(We,[["__scopeId","data-v-08477ae3"]]),Ue={id:"ram",style:{transform:"translate(1704px, 136px)"}},Me=R({__name:"DataMemory",props:{cpu:{type:q,required:!0}},setup(e,{expose:t}){const l=e,u=c([]);t({doFocus(){u.value[0]?.doFocus(3)}});const m=l.cpu.ram;return(p,d)=>(h(),x("g",Ue,[d[0]||(d[0]=i("path",{class:"component-bg",d:"m 0,0 v 720 40 h 120 v -40 h 80 V 0 Z"},null,-1)),d[1]||(d[1]=i("text",{class:"component-label",x:"30",y:"40"}," RAM ",-1)),r(Y,{x:8,y:56+40*(e.cpu.address.value%4)+168*Math.floor(e.cpu.address.value/4)},null,8,["y"]),(h(),x(F,null,D([0,1,2,3],v=>i("g",{key:"data_"+v},[(h(),x(F,null,D([0,1,2,3],g=>i("g",{key:"data_"+v+"_"+g},[r(j,{x:32,y:48+40*g+168*v,ref_for:!0,ref_key:"dataComp",ref:u,modelValue:a(m)[g+v*4],"onUpdate:modelValue":S=>a(m)[g+v*4]=S},null,8,["y","modelValue","onUpdate:modelValue"])])),64))])),64)),r(K,{dir:"up",x:40,y:720,value:e.cpu.ramWrite},null,8,["value"]),r(K,{dir:"down",x:72,y:720,value:e.cpu.ramRead},null,8,["value"])]))}});function ee(e,t){return`transform: translate(${e}px, ${t}px)`}const Ne=R({__name:"IncrementorUnit",setup(e){return(t,l)=>(h(),x("g",{id:"pc_incrementor",style:O(a(ee)(568,720))},l[0]||(l[0]=[i("rect",{class:"component-bg",width:"72",height:"48",x:"0",y:"0"},null,-1),i("text",{class:"component-label",x:"36",y:"24","text-anchor":"middle","dominant-baseline":"central"}," +1 ",-1)]),4))}}),Fe=["width"],De=["width"],je=R({__name:"ToggleBtn",props:{x:Number,y:Number,width:Number,modelValue:Boolean,label:String},emits:["update:modelValue"],setup(e,{expose:t,emit:l}){const u=c(null);t({doFocus(){const p=u.value;p&&p.focus()}});const m=l;return(p,d)=>(h(),x("g",{class:_({active:e.modelValue}),style:O({transform:"translate("+e.x+"px, "+e.y+"px)"}),onClick:d[0]||(d[0]=v=>m("update:modelValue",!e.modelValue)),onKeypress:d[1]||(d[1]=v=>m("update:modelValue",!e.modelValue)),tabindex:"0",ref_key:"focusTarget",ref:u},[i("rect",{width:e.width,height:32},null,8,Fe),i("text",{x:"4",y:"16",height:"32",width:e.width,style:{"text-anchor":"start"}},C(e.label),9,De)],38))}}),qe=M(je,[["__scopeId","data-v-5a4b0916"]]),Ze={id:"programm",style:{transform:"translate(16px, 136px)"}},Le=["y"],Ce=["onUpdate:modelValue"],ze=["value"],Ie=R({__name:"InstructionMemory",props:{cpu:{type:q,required:!0}},setup(e){const t=e,l=c([]),u=c([]),m=c([]),p=t.cpu.instructionsOp,d=t.cpu.instructionsAddr,v=t.cpu.instructionsData,g=c(!1),S=$(()=>t.cpu.decoderState.instructions);return(W,n)=>(h(),x("g",Ze,[n[1]||(n[1]=i("rect",{class:"component-bg",width:"536",height:"720",x:"0",y:"0"},null,-1)),n[2]||(n[2]=i("text",{class:"component-label",x:"30",y:"40"},"ROM",-1)),r(Y,{x:8,y:56+40*(e.cpu.pc.value%4)+168*Math.floor(e.cpu.pc.value/4)},null,8,["y"]),r(qe,{x:370,y:8,width:150,label:g.value?"Ins":"Binary",modelValue:g.value,"onUpdate:modelValue":n[0]||(n[0]=y=>g.value=y)},null,8,["label","modelValue"]),(h(),x(F,null,D([0,1,2,3],y=>i("g",{key:y},[(h(),x(F,null,D([0,1,2,3],s=>i("g",{key:y+"_"+s},[g.value?(h(),x("foreignObject",{key:0,x:"32",y:48+40*s+168*y,width:152,height:32},[de(i("select",{style:{height:"100%",width:"100%"},"onUpdate:modelValue":o=>a(p)[s+y*4]=o},[(h(!0),x(F,null,D(S.value,(o,V)=>(h(),x("option",{key:o.name,value:V},C(o.name),9,ze))),128))],8,Ce),[[ve,a(p)[s+y*4]]])],8,Le)):(h(),X(j,{key:1,x:32,y:48+40*s+168*y,ref_for:!0,ref_key:"ref_inst",ref:l,modelValue:a(p)[s+y*4],"onUpdate:modelValue":o=>a(p)[s+y*4]=o,onKeydown:[A(B(o=>u.value[s+y*4].doFocus(3),["stop"]),["right"]),A(B(o=>m.value[(s+y*4+15)%16].doFocus(),["stop"]),["left"])],onUp:o=>l.value[(s+y*4+15)%16].doFocus(o),onDown:o=>l.value[(s+y*4+1)%16].doFocus(o)},null,8,["y","modelValue","onUpdate:modelValue","onKeydown","onUp","onDown"])),r(j,{x:200,y:48+40*s+168*y,ref_for:!0,ref_key:"ref_addr",ref:u,modelValue:a(d)[s+y*4],"onUpdate:modelValue":o=>a(d)[s+y*4]=o,onKeydown:[A(B(o=>m.value[s+y*4].doFocus(3),["stop"]),["right"]),A(B(o=>l.value[s+y*4].doFocus(),["stop"]),["left"])],onUp:o=>u.value[(s+y*4+15)%16].doFocus(o),onDown:o=>u.value[(s+y*4+1)%16].doFocus(o)},null,8,["y","modelValue","onUpdate:modelValue","onKeydown","onUp","onDown"]),r(j,{x:368,y:48+40*s+168*y,ref_for:!0,ref_key:"ref_data",ref:m,modelValue:a(v)[s+y*4],"onUpdate:modelValue":o=>a(v)[s+y*4]=o,onKeydown:[A(B(o=>l.value[(s+y*4+1)%16].doFocus(3),["stop"]),["right"]),A(B(o=>u.value[s+y*4].doFocus(),["stop"]),["left"])],onUp:o=>m.value[(s+y*4+15)%16].doFocus(o),onDown:o=>m.value[(s+y*4+1)%16].doFocus(o)},null,8,["y","modelValue","onUpdate:modelValue","onKeydown","onUp","onDown"])])),64))])),64))]))}}),Ee=M(Ie,[["__scopeId","data-v-0048b438"]]),Ke=R({__name:"JumpManager",setup(e){return(t,l)=>(h(),x("g",{id:"jmpManager",style:O(a(ee)(912,432))},l[0]||(l[0]=[i("rect",{class:"component-bg",width:"56",height:"56",x:"0",y:"0"},null,-1),i("text",{class:"component-label",x:"28",y:"28","text-anchor":"middle","dominant-baseline":"central"}," JP ",-1)]),4))}}),Pe={id:"pc",style:{transform:"translate(704px, 632px)"}},Te=R({__name:"ProgramCounter",props:{jump:{type:Boolean,required:!0},modelValue:{type:Number,required:!0}},emits:["update:modelValue"],setup(e){return(t,l)=>(h(),x("g",Pe,[l[1]||(l[1]=i("rect",{class:"component-bg",width:"168",height:"136",x:"0",y:"0"},null,-1)),l[2]||(l[2]=i("text",{class:"component-label",x:"8",y:"40"}," PC ",-1)),r(j,{x:8,y:56,"model-value":e.modelValue,"onUpdate:modelValue":l[0]||(l[0]=u=>t.$emit("update:modelValue",u))},null,8,["model-value"]),r(K,{dir:"up",value:!e.jump,x:24,y:98},null,8,["value"]),r(K,{dir:"up",value:e.jump,x:120,y:98},null,8,["value"])]))}}),Qe={class:"component-label",x:"8",y:"40"},G=R({__name:"DataRegister",props:{x:{type:Number,required:!0},y:{type:Number,required:!0},name:{type:String,required:!0},modelValue:{type:Number,required:!0},commandRead:{type:Boolean,required:!0},commandWrite:{type:Boolean,required:!0}},emits:["update:modelValue"],setup(e){return(t,l)=>(h(),x("g",{style:O(`transform: translate(${e.x}px, ${e.y}px)`)},[l[1]||(l[1]=i("rect",{class:"component-bg",width:"168",height:"96",x:"0",y:"0"},null,-1)),r(j,{x:8,y:56,"model-value":e.modelValue,"onUpdate:modelValue":l[0]||(l[0]=u=>t.$emit("update:modelValue",u))},null,8,["model-value"]),i("text",Qe,C(e.name),1),i("text",{class:_(["component-port-label",{active:e.commandRead}]),x:"154",y:"28"}," R ",2),i("text",{class:_(["component-port-label",{active:e.commandWrite}]),x:"154",y:"12"}," W ",2)],4))}}),Ge={"xmlns:svg":"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1920 1080",version:"1.1",height:"100%",width:"100%"},Je=R({__name:"CPU",props:{excerciseState:{type:Object,required:!0},decoderState:{type:Object,required:!0}},setup(e){const t=e,l=c(null),u=c(null),m=c(null),p=c(null),d=c(null),v=c(null),g=c(null),S=[v,l,u,m,p,d,g];function W(y,s){if(s.key==="PageUp"||s.key==="PageDown"){const o=s.key==="PageUp"?S.length-1:1,V=S.findIndex(f=>f.value===y);if(V===-1)return;S[(V+o)%S.length]?.value?.doFocus(),s.preventDefault(),s.stopPropagation()}}const n=ce(new q(t.decoderState));return(y,s)=>(h(),x("svg",Ge,[i("g",null,[s[12]||(s[12]=i("text",{x:"4",y:"1008",id:"databus_label"},"Data",-1)),r(w,{id:"main_data_bus",x:0,y:1016,value:a(n).data.value,dir:"horizontal",length:1920},null,8,["value"]),s[13]||(s[13]=i("text",{x:"8",y:"904",id:"addressbus_label"},"Address",-1)),r(w,{id:"main_address_bus",x:0,y:912,value:a(n).address.value,dir:"horizontal",length:1920},null,8,["value"]),r(w,{id:"program_out_address",x:264,y:856,value:a(n).address.value,dir:"vertical",length:112,taperedEnd:""},null,8,["value"]),r(w,{id:"program_out_data",x:432,y:856,value:a(n).data.value,dir:"vertical",length:216,taperedEnd:""},null,8,["value"]),r(w,{id:"pc_in_address",x:808,y:768,value:a(n).address.value,dir:"vertical",length:200,taperedEnd:""},null,8,["value"]),r(w,{id:"incrementor_bus",x:576,y:776,value:a(n).pc.value+1,dir:"horizontal",length:192,taperedStart:"",taperedEnd:""},null,8,["value"]),r(w,{id:"incrementor_out",x:576,y:768,value:a(n).pc.value+1,dir:"vertical",length:64,taperedEnd:""},null,8,["value"]),r(w,{id:"pc_incrementor_in",x:712,y:768,value:a(n).pc.value+1,dir:"vertical",length:64,taperedEnd:""},null,8,["value"]),r(w,{id:"pc_bus",x:552,y:640,value:a(n).pc.value,dir:"horizontal",length:152},null,8,["value"]),r(w,{id:"incrementor_in",x:576,y:640,value:a(n).pc.value,dir:"vertical",length:80,taperedStart:""},null,8,["value"]),r(w,{id:"alu_out",x:1144,y:592,value:a(n).data.value,dir:"vertical",length:480,taperedEnd:""},null,8,["value"]),r(w,{id:"databus_registers_ext",x:1568,y:200,value:a(n).data.value,dir:"vertical",length:872,taperedStart:"",taperedEnd:""},null,8,["value"]),r(w,{id:"databus_registers",x:1040,y:200,value:a(n).data.value,dir:"horizontal",length:582,taperedStart:"",taperedEnd:""},null,8,["value"]),r(w,{id:"register_A_in",x:1040,y:200,value:a(n).data.value,dir:"vertical",length:64,taperedStart:""},null,8,["value"]),r(w,{id:"register_B_in",x:1248,y:200,value:a(n).data.value,dir:"vertical",length:64,taperedStart:""},null,8,["value"]),r(b,{dir:"horizontal",length:16,value:a(n).flagZ.value,x:968,y:448},null,8,["value"]),r(b,{dir:"horizontal",length:16,value:a(n).flagO.value,x:968,y:464},null,8,["value"]),r(b,{length:264,x:936,y:488,dir:"vertical",value:a(n).pcJump},null,8,["value"]),r(b,{length:72,x:872,y:744,dir:"horizontal",value:a(n).pcJump},null,8,["value"]),r(b,{length:328,x:920,y:104,dir:"vertical",value:a(n).jmpNot},null,8,["value"]),r(b,{length:328,x:936,y:104,dir:"vertical",value:a(n).jmpZero},null,8,["value"]),r(b,{length:328,x:952,y:104,dir:"vertical",value:a(n).jmpOverflow},null,8,["value"]),r(b,{dir:"horizontal",value:a(n).regAWrite,length:16,x:1152,y:272},null,8,["value"]),r(b,{dir:"vertical",value:a(n).regAWrite,length:176,x:1160,y:104},null,8,["value"]),r(b,{dir:"horizontal",value:a(n).regARead,length:32,x:1152,y:288},null,8,["value"]),r(b,{dir:"vertical",value:a(n).regARead,length:192,x:1176,y:104},null,8,["value"]),r(b,{dir:"horizontal",value:a(n).regBWrite,length:16,x:1360,y:272},null,8,["value"]),r(b,{dir:"vertical",value:a(n).regBWrite,length:176,x:1368,y:104},null,8,["value"]),r(b,{dir:"horizontal",value:a(n).regBRead,length:32,x:1360,y:288},null,8,["value"]),r(b,{dir:"vertical",value:a(n).regBRead,length:192,x:1384,y:104},null,8,["value"]),r(b,{dir:"horizontal",value:a(n).ramWrite,length:32,x:1672,y:856},null,8,["value"]),r(b,{dir:"vertical",value:a(n).ramWrite,length:760,x:1672,y:104},null,8,["value"]),r(b,{dir:"horizontal",value:a(n).ramRead,length:48,x:1656,y:872},null,8,["value"]),r(b,{dir:"vertical",value:a(n).ramRead,length:776,x:1656,y:104},null,8,["value"]),r(w,{dir:"vertical",length:32,value:a(n).instructionsOp[a(n).pc.value],x:96,y:104},null,8,["value"]),r(b,{dir:"horizontal",value:!!(a(n).aluOp&1),length:56,x:1360,y:416},null,8,["value"]),r(b,{dir:"vertical",value:!!(a(n).aluOp&1),length:320,x:1408,y:104},null,8,["value"]),r(b,{dir:"horizontal",value:!!(a(n).aluOp&2),length:72,x:1360,y:432},null,8,["value"]),r(b,{dir:"vertical",value:!!(a(n).aluOp&2),length:336,x:1424,y:104},null,8,["value"]),r(w,{id:"ram_in_address",x:1840,y:856,value:a(n).address.value,dir:"vertical",length:112,taperedEnd:""},null,8,["value"]),r(w,{id:"databus_ram",x:1744,y:896,value:a(n).data.value,dir:"vertical",length:176,taperedEnd:""},null,8,["value"]),r(Re,{ref_key:"controlComp",ref:v,cpu:a(n),onKeydown:s[0]||(s[0]=o=>W(v.value,o))},null,8,["cpu"]),r(Ee,{ref_key:"romComp",ref:l,cpu:a(n),onKeydown:s[1]||(s[1]=o=>W(l.value,o))},null,8,["cpu"]),r(Me,{ref_key:"dataComp",ref:u,cpu:a(n),onKeydown:s[2]||(s[2]=o=>W(u.value,o))},null,8,["cpu"]),r(G,{name:"A",x:984,y:264,ref_key:"regAComp",ref:m,modelValue:a(n).regA.value,"onUpdate:modelValue":s[3]||(s[3]=o=>a(n).regA.value=o),"command-read":a(n).regARead,"command-write":a(n).regAWrite,onKeydown:s[4]||(s[4]=o=>W(m.value,o))},null,8,["modelValue","command-read","command-write"]),r(G,{name:"B",x:1192,y:264,ref_key:"regBComp",ref:p,modelValue:a(n).regB.value,"onUpdate:modelValue":s[5]||(s[5]=o=>a(n).regB.value=o),"command-read":a(n).regBRead,"command-write":a(n).regBWrite,onKeydown:s[6]||(s[6]=o=>W(p.value,o))},null,8,["modelValue","command-read","command-write"]),r(ke,{ref_key:"aluComp",ref:d,select:a(n).aluOp,"flag-z":a(n).flagZ.value,"onUpdate:flagZ":s[7]||(s[7]=o=>a(n).flagZ.value=o),"flag-o":a(n).flagO.value,"onUpdate:flagO":s[8]||(s[8]=o=>a(n).flagO.value=o),onKeydown:s[9]||(s[9]=o=>W(d.value,o))},null,8,["select","flag-z","flag-o"]),r(w,{id:"alu_in_A",dir:"vertical",length:40,x:1040,y:360,value:a(n).regA.value},null,8,["value"]),r(w,{id:"alu_in_B",dir:"vertical",length:40,x:1248,y:360,value:a(n).regB.value},null,8,["value"]),r(Ke),r(Te,{ref_key:"pcComp",ref:g,modelValue:a(n).pc.value,"onUpdate:modelValue":s[10]||(s[10]=o=>a(n).pc.value=o),jump:a(n).pcJump,onKeydown:s[11]||(s[11]=o=>W(g.value,o))},null,8,["modelValue","jump"]),r(Ne)])]))}}),He=M(Je,[["__scopeId","data-v-358ac38f"]]),Xe={0:{value:1,blocked:!0},1:{value:1,blocked:!0},2:{value:0,blocked:!1},3:{value:0,blocked:!1},4:{value:0,blocked:!1},5:{value:0,blocked:!1},6:{value:0,blocked:!1},7:{value:0,blocked:!1},8:{value:0,blocked:!1},9:{value:0,blocked:!1},10:{value:3,blocked:!0},11:{value:0,blocked:!1},12:{value:0,blocked:!1},13:{value:0,blocked:!1},14:{value:0,blocked:!1},15:{value:0,blocked:!1}},Ye={instructions:{0:{value:0,blocked:!1},1:{value:0,blocked:!1},2:{value:0,blocked:!1},3:{value:5,blocked:!0},4:{value:0,blocked:!1},5:{value:0,blocked:!1},6:{value:0,blocked:!1},7:{value:0,blocked:!1},8:{value:0,blocked:!1},9:{value:0,blocked:!1},10:{value:0,blocked:!1},11:{value:0,blocked:!1},12:{value:0,blocked:!1},13:{value:0,blocked:!1},14:{value:0,blocked:!1},15:{value:0,blocked:!1}},addresses:{0:{value:0,blocked:!1},1:{value:9,blocked:!0},2:{value:0,blocked:!1},3:{value:0,blocked:!1},4:{value:4,blocked:!1},5:{value:0,blocked:!1},6:{value:0,blocked:!1},7:{value:7,blocked:!0},8:{value:0,blocked:!1},9:{value:0,blocked:!1},10:{value:0,blocked:!1},11:{value:0,blocked:!1},12:{value:0,blocked:!1},13:{value:0,blocked:!1},14:{value:0,blocked:!1},15:{value:0,blocked:!1}},data:{0:{value:0,blocked:!1},1:{value:0,blocked:!1},2:{value:0,blocked:!1},3:{value:0,blocked:!1},4:{value:0,blocked:!1},5:{value:0,blocked:!1},6:{value:0,blocked:!1},7:{value:8,blocked:!1},8:{value:0,blocked:!1},9:{value:0,blocked:!1},10:{value:0,blocked:!1},11:{value:0,blocked:!1},12:{value:0,blocked:!1},13:{value:0,blocked:!1},14:{value:0,blocked:!1},15:{value:0,blocked:!1}}},J={dataMemoryState:Xe,instructionMemoryState:Ye},et=[{name:"NOP",gates:[]},{name:"LD A",gates:["AW"]},{name:"LR A",gates:["AW","RR"]},{name:"LD B",gates:["BW"]},{name:"LR B",gates:["BW","RR"]},{name:"LD B, A",gates:["AR","BW"]},{name:"LD A, B",gates:["AW","BR"]},{name:"ST A",gates:["AR","RW"]},{name:"ST B",gates:["BR","RW"]},{name:"AND",gates:["AW","ALU1"]},{name:"ADD",gates:["AW","ALU2"]},{name:"SUB",gates:["AW","ALU1","ALU2"]},{name:"JMP",gates:["JN"]},{name:"JMZ",gates:["JZ"]},{name:"JMO",gates:["JO"]},{name:"JNZ",gates:["JN","JZ"]}],tt={fetch:["JN","JZ","JO"],decode:[],read:["AR","BR","RR"],exec:["AR","BR","RR","ALU1","ALU2"],write:["AR","BR","RR","ALU1","ALU2","AW","BW","RW"]},H={instructions:et,timingMasks:tt};function lt(e){return{instructions:e.instructions.map(t=>({name:t.name,gates:new Set(t.gates)})),timingMasks:{[U.Fetch]:new Set(e.timingMasks.fetch),[U.Decode]:new Set(e.timingMasks.decode),[U.Read]:new Set(e.timingMasks.read),[U.Execute]:new Set(e.timingMasks.exec),[U.Write]:new Set(e.timingMasks.write)}}}const te=new Set(["JN","JZ","JO","RR","RW","AR","AW","BR","BW","ALU1","ALU2"]);function at(e){return!(typeof e!="object"||e===null||!("instructions"in e)||!Array.isArray(e.instructions)||!e.instructions.every(t=>!(typeof t!="object"||t===null||!("name"in t)||typeof t.name!="string"||!("gates"in t)||!Array.isArray(t.gates)||!t.gates.every(l=>typeof l=="string"&&te.has(l))))||!("timingMasks"in e)||typeof e.timingMasks!="object"||e.timingMasks===null||!("fetch"in e.timingMasks)||!L(e.timingMasks.fetch)||!("decode"in e.timingMasks)||!L(e.timingMasks.decode)||!("read"in e.timingMasks)||!L(e.timingMasks.read)||!("exec"in e.timingMasks)||!L(e.timingMasks.exec)||!("write"in e.timingMasks)||!L(e.timingMasks.write))}function L(e){return!(!Array.isArray(e)||!e.every(t=>typeof t=="string"&&te.has(t)))}const st=R({__name:"IndexPage",setup(e){const t=$(()=>({dataMemoryState:J.dataMemoryState,instructionMemoryState:J.instructionMemoryState}));if(!at(H))throw new Error("Invalid decoder state");const l=lt(H);return(u,m)=>(h(),X(a(ge),{class:"row items-center justify-evenly"},{default:me(()=>[r(He,{excerciseState:t.value,decoderState:a(l)},null,8,["excerciseState","decoderState"])]),_:1}))}});export{st as default};
